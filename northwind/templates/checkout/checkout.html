{% extends 'base.html' %}

{% block header %}
<h1>{% block title %}Checkout{% endblock %}</h1>
{% endblock %}

{% block content %}
{% if g.user %}
<div class="table-responsive mt-4">
  <table class="table align-middle">
      <thead class="table-light">
          <tr>
              <th scope="col" style="min-width: 300px;">Item</th>
              <th scope="col" class="text-center">Price</th>
              <th scope="col" class="text-center">Quantity</th>
              <th scope="col" class="text-end">Subtotal</th>
          </tr>
      </thead>
      <tbody>
          {% for item in cart_items %}
          <tr>
              <td>
                  <div class="d-flex align-items-center fw-bold mb-1 text-dark" style="font-size: 1.1rem;">
                      
                      <p class="mb-0">{{ item['ProductName'] }}</p>
                  </div>
              </td>
              <td class="text-center">
                  <span class="fw-semibold">
                      ${{ "%.2f"|format(item['UnitPrice']) }}
                  </span>
              </td>
              <td class="text-center" style="width: 150px;">
                  <form action="{{ url_for('cart.update_quantity') }}" method="post">
                      <div class="input-group input-group-sm" style="width: 120px;">
                          
                          <p class="form-control form-control-sm text-center m-0">{{item['Quantity']}}</p>
                          
                      </div>
                  </form>
              </td>
              <td class="text-end">
                  <span class="fw-semibold">
                      ${{ "%.2f"|format(item['UnitPrice'] * item['Quantity']) }}
                  </span>
              </td>
          </tr>
          {% endfor %}
      </tbody>
  </table>
</div>
<div class="d-flex justify-content-end align-items-center mt-3">
  <h4 class="me-3">Cart Total: ${{ "%.2f"|format(total_amount) }}</h4>
</div>

{% else %}
<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="text-center mb-4">
        <h5>Log In or Register In Order to Complete Purchase</h5>
        <p class="lead">Subtotal for {{ num_items }} Item(s): ${{ total_amount }}</p>
      </div>
      <div class="d-flex flex-column">
        <a href="{{ url_for('auth.register', next=request.path) }}" class="btn btn-primary btn-lg mb-3">
          Register
        </a>
        <a href="{{ url_for('auth.login', next=request.path) }}" class="btn btn-secondary btn-lg">
          Log In
        </a>
      </div>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}